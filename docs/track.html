

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Track Reference &mdash; Rally 2.0.4.dev0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configure Elasticsearch: Cars" href="car.html" />
    <link rel="prev" title="Offline Usage" href="offline.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Rally
          

          
          </a>

          
            
            
              <div class="version">
                2.0.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started with Rally</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Running Rally with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="race.html">Run a Benchmark: Races</a></li>
<li class="toctree-l1"><a class="reference internal" href="tournament.html">Compare Results: Tournaments</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster_management.html">Setting up a Cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Tips and Tricks</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending Rally</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="adding_tracks.html">Define Custom Workloads: Tracks</a></li>
<li class="toctree-l1"><a class="reference internal" href="developing.html">Developing Rally</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="versions.html">Elasticsearch Version Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line_reference.html">Command Line Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="offline.html">Offline Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Track Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#definition">Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#track-file-format-and-storage">Track File Format and Storage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ad-hoc-use">Ad-hoc use</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-track-repositories">Custom Track Repositories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creating-a-new-track-repository">Creating a new track repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adding-an-already-existing-track-repository">Adding an already existing track repository</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#when-to-use-what">When to use what?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#anatomy-of-a-track">Anatomy of a track</a></li>
<li class="toctree-l2"><a class="reference internal" href="#track-elements">Track elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#meta">meta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#indices">indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#templates">templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-streams">data-streams</a></li>
<li class="toctree-l3"><a class="reference internal" href="#composable-templates">composable-templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#component-templates">component-templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#corpora">corpora</a></li>
<li class="toctree-l3"><a class="reference internal" href="#challenge">challenge</a></li>
<li class="toctree-l3"><a class="reference internal" href="#schedule">schedule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#defining-operations">Defining operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#choosing-a-schedule">Choosing a schedule</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-based-vs-iteration-based">Time-based vs. iteration-based</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#operations">operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bulk">bulk</a></li>
<li class="toctree-l4"><a class="reference internal" href="#force-merge">force-merge</a></li>
<li class="toctree-l4"><a class="reference internal" href="#index-stats">index-stats</a></li>
<li class="toctree-l4"><a class="reference internal" href="#node-stats">node-stats</a></li>
<li class="toctree-l4"><a class="reference internal" href="#search">search</a></li>
<li class="toctree-l4"><a class="reference internal" href="#put-pipeline">put-pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="#put-settings">put-settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cluster-health">cluster-health</a></li>
<li class="toctree-l4"><a class="reference internal" href="#refresh">refresh</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-index">create-index</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-index">delete-index</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-data-stream">create-data-stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-data-stream">delete-data-stream</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-composable-template">create-composable-template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-component-template">create-component-template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-index-template">create-index-template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-composable-template">delete-composable-template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-component-template">delete-component-template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-index-template">delete-index-template</a></li>
<li class="toctree-l4"><a class="reference internal" href="#shrink-index">shrink-index</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-ml-datafeed">delete-ml-datafeed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-ml-datafeed">create-ml-datafeed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-ml-datafeed">start-ml-datafeed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#stop-ml-datafeed">stop-ml-datafeed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-ml-job">delete-ml-job</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-ml-job">create-ml-job</a></li>
<li class="toctree-l4"><a class="reference internal" href="#open-ml-job">open-ml-job</a></li>
<li class="toctree-l4"><a class="reference internal" href="#close-ml-job">close-ml-job</a></li>
<li class="toctree-l4"><a class="reference internal" href="#raw-request">raw-request</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sleep">sleep</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-snapshot-repository">delete-snapshot-repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-snapshot-repository">create-snapshot-repository</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-snapshot">create-snapshot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wait-for-snapshot-create">wait-for-snapshot-create</a></li>
<li class="toctree-l4"><a class="reference internal" href="#restore-snapshot">restore-snapshot</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wait-for-recovery">wait-for-recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-transform">create-transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-transform">start-transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wait-for-transform">wait-for-transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-transform">delete-transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="#composite">composite</a></li>
<li class="toctree-l4"><a class="reference internal" href="#submit-async-search">submit-async-search</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-async-search">get-async-search</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-async-search">delete-async-search</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-track-with-a-single-task">A track with a single task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-unthrottled">Running unthrottled</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-tasks-in-parallel">Running tasks in parallel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="car.html">Configure Elasticsearch: Cars</a></li>
<li class="toctree-l1"><a class="reference internal" href="elasticsearch_plugins.html">Using Elasticsearch Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="telemetry.html">Telemetry Devices</a></li>
<li class="toctree-l1"><a class="reference internal" href="rally_daemon.html">Rally Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipelines.html">Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary_report.html">Summary Report</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional Information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="migrate.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Community Resources</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Rally</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

    <ul class="wy-breadcrumbs">
        
        <li><a href="index.html">Docs</a> &raquo;</li>
        
        <li>Track Reference</li>
        
        
        <li class="wy-breadcrumbs-aside">
            
            
            <a href="_sources/track.rst.txt" rel="nofollow"> View page source</a>
            
            
        </li>
        
    </ul>

    
    <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="track-reference">
<h1>Track Reference<a class="headerlink" href="#track-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definition">
<h2>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h2>
<p>A track is a specification of one or more benchmarking scenarios with a specific document corpus. It defines for example the involved indices or data streams, data files and the operations that are invoked. Its most important attributes are:</p>
<ul class="simple">
<li><p>One or more indices or data streams, with the former potentially each having one or more types.</p></li>
<li><p>The queries to issue.</p></li>
<li><p>Source URL of the benchmark data.</p></li>
<li><p>A list of steps to run, which we’ll call “challenge”, for example indexing data with a specific number of documents per bulk request or running searches for a defined number of iterations.</p></li>
</ul>
</div>
<div class="section" id="track-file-format-and-storage">
<h2>Track File Format and Storage<a class="headerlink" href="#track-file-format-and-storage" title="Permalink to this headline">¶</a></h2>
<p>A track is specified in a JSON file.</p>
<div class="section" id="ad-hoc-use">
<h3>Ad-hoc use<a class="headerlink" href="#ad-hoc-use" title="Permalink to this headline">¶</a></h3>
<p>For ad-hoc use you can store a track definition anywhere on the file system and reference it with <code class="docutils literal notranslate"><span class="pre">--track-path</span></code>, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># provide a directory - Rally searches for a track.json file in this directory</span>
<span class="c1"># Track name is &quot;app-logs&quot;</span>
<span class="n">esrally</span> <span class="o">--</span><span class="n">track</span><span class="o">-</span><span class="n">path</span><span class="o">=~/</span><span class="n">Projects</span><span class="o">/</span><span class="n">tracks</span><span class="o">/</span><span class="n">app</span><span class="o">-</span><span class="n">logs</span>
<span class="c1"># provide a file name - Rally uses this file directly</span>
<span class="c1"># Track name is &quot;syslog&quot;</span>
<span class="n">esrally</span> <span class="o">--</span><span class="n">track</span><span class="o">-</span><span class="n">path</span><span class="o">=~/</span><span class="n">Projects</span><span class="o">/</span><span class="n">tracks</span><span class="o">/</span><span class="n">syslog</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>Rally will also search for additional files like mappings or data files in the provided directory. If you use advanced features like <a class="reference internal" href="adding_tracks.html#adding-tracks-custom-runners"><span class="std std-ref">custom runners</span></a> or <a class="reference internal" href="adding_tracks.html#adding-tracks-custom-param-sources"><span class="std std-ref">parameter sources</span></a> we recommend that you create a separate directory per track.</p>
</div>
<div class="section" id="custom-track-repositories">
<h3>Custom Track Repositories<a class="headerlink" href="#custom-track-repositories" title="Permalink to this headline">¶</a></h3>
<p>Alternatively, you can store Rally tracks also in a dedicated git repository which we call a “track repository”. Rally provides a default track repository that is hosted on <a class="reference external" href="https://github.com/elastic/rally-tracks">Github</a>. You can also add your own track repositories although this requires a bit of additional work. First of all, track repositories need to be managed by git. The reason is that Rally can benchmark multiple versions of Elasticsearch and we use git branches in the track repository to determine the best match for each track (based on the command line parameter <code class="docutils literal notranslate"><span class="pre">--distribution-version</span></code>). The versioning scheme is as follows:</p>
<ul class="simple">
<li><p>The <cite>master</cite> branch needs to work with the latest <cite>master</cite> branch of Elasticsearch.</p></li>
<li><p>All other branches need to match the version scheme of Elasticsearch, i.e. <code class="docutils literal notranslate"><span class="pre">MAJOR.MINOR.PATCH-SUFFIX</span></code> where all parts except <code class="docutils literal notranslate"><span class="pre">MAJOR</span></code> are optional.</p></li>
</ul>
<p>Rally implements a fallback logic so you don’t need to define a branch for each patch release of Elasticsearch. For example:</p>
<ul class="simple">
<li><p>The branch <cite>6.0.0-alpha1</cite> will be chosen for the version <code class="docutils literal notranslate"><span class="pre">6.0.0-alpha1</span></code> of Elasticsearch.</p></li>
<li><p>The branch <cite>5</cite> will be chosen for all versions for Elasticsearch with the major version 5, e.g. <code class="docutils literal notranslate"><span class="pre">5.0.0</span></code>, <code class="docutils literal notranslate"><span class="pre">5.1.3</span></code> (provided there is no specific branch).</p></li>
</ul>
<p>Rally tries to use the branch with the best match to the benchmarked version of Elasticsearch.</p>
<p>Rally will also search for related files like mappings or custom runners or parameter sources in the track repository. However, Rally will use a separate directory to look for data files (<code class="docutils literal notranslate"><span class="pre">~/.rally/benchmarks/data/$TRACK_NAME/</span></code>). The reason is simply that we do not want to check multi-GB data files into git.</p>
<div class="section" id="creating-a-new-track-repository">
<h4>Creating a new track repository<a class="headerlink" href="#creating-a-new-track-repository" title="Permalink to this headline">¶</a></h4>
<p>All track repositories are located in <code class="docutils literal notranslate"><span class="pre">~/.rally/benchmarks/tracks</span></code>. If you want to add a dedicated track repository, called <code class="docutils literal notranslate"><span class="pre">private</span></code> follow these steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/.</span><span class="n">rally</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">tracks</span>
<span class="n">mkdir</span> <span class="n">private</span>
<span class="n">cd</span> <span class="n">private</span>
<span class="n">git</span> <span class="n">init</span>
<span class="c1"># add your track now</span>
<span class="n">git</span> <span class="n">add</span> <span class="o">.</span>
<span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;Initial commit&quot;</span>
</pre></div>
</div>
<p>If you want to share your tracks with others you need to add a remote and push it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">remote</span> <span class="n">add</span> <span class="n">origin</span> <span class="n">git</span><span class="nd">@git</span><span class="o">-</span><span class="n">repos</span><span class="o">.</span><span class="n">acme</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">acme</span><span class="o">/</span><span class="n">rally</span><span class="o">-</span><span class="n">tracks</span><span class="o">.</span><span class="n">git</span>
<span class="n">git</span> <span class="n">push</span> <span class="o">-</span><span class="n">u</span> <span class="n">origin</span> <span class="n">master</span>
</pre></div>
</div>
<p>If you have added a remote you should also add it in <code class="docutils literal notranslate"><span class="pre">~/.rally/rally.ini</span></code>, otherwise you can skip this step. Open the file in your editor of choice and add the following line in the section <code class="docutils literal notranslate"><span class="pre">tracks</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">private</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="n">URL_TO_YOUR_ORIGIN</span><span class="o">&gt;&gt;</span>
</pre></div>
</div>
<p>If you specify <code class="docutils literal notranslate"><span class="pre">--track-repository=private</span></code>, Rally will check whether there is a directory <code class="docutils literal notranslate"><span class="pre">~/.rally/benchmarks/tracks/private</span></code>. If there is none, it will use the provided URL to clone the repo. However, if the directory already exists, the property gets ignored and Rally will just update the local tracking branches before the benchmark starts.</p>
<p>You can now verify that everything works by listing all tracks in this track repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">esrally</span> <span class="nb">list</span> <span class="n">tracks</span> <span class="o">--</span><span class="n">track</span><span class="o">-</span><span class="n">repository</span><span class="o">=</span><span class="n">private</span>
</pre></div>
</div>
<p>This shows all tracks that are available on the <code class="docutils literal notranslate"><span class="pre">master</span></code> branch of this repository. Suppose you only created tracks on the branch <code class="docutils literal notranslate"><span class="pre">2</span></code> because you’re interested in the performance of Elasticsearch 2.x, then you can specify also the distribution version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">esrally</span> <span class="nb">list</span> <span class="n">tracks</span> <span class="o">--</span><span class="n">track</span><span class="o">-</span><span class="n">repository</span><span class="o">=</span><span class="n">private</span> <span class="o">--</span><span class="n">distribution</span><span class="o">-</span><span class="n">version</span><span class="o">=</span><span class="mf">7.0</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
<p>Rally will follow the same branch fallback logic as described above.</p>
</div>
<div class="section" id="adding-an-already-existing-track-repository">
<h4>Adding an already existing track repository<a class="headerlink" href="#adding-an-already-existing-track-repository" title="Permalink to this headline">¶</a></h4>
<p>If you want to add a track repository that already exists, just open <code class="docutils literal notranslate"><span class="pre">~/.rally/rally.ini</span></code> in your editor of choice and add the following line in the section <code class="docutils literal notranslate"><span class="pre">tracks</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">your_repo_name</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="n">URL_TO_YOUR_ORIGIN</span><span class="o">&gt;&gt;</span>
</pre></div>
</div>
<p>After you have added this line, have Rally list the tracks in this repository:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">esrally</span> <span class="nb">list</span> <span class="n">tracks</span> <span class="o">--</span><span class="n">track</span><span class="o">-</span><span class="n">repository</span><span class="o">=</span><span class="n">your_repo_name</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="when-to-use-what">
<h3>When to use what?<a class="headerlink" href="#when-to-use-what" title="Permalink to this headline">¶</a></h3>
<p>We recommend the following path:</p>
<ul class="simple">
<li><p>Start with a simple json file. The file name can be arbitrary.</p></li>
<li><p>If you need <a class="reference internal" href="adding_tracks.html#adding-tracks-custom-runners"><span class="std std-ref">custom runners</span></a> or <a class="reference internal" href="adding_tracks.html#adding-tracks-custom-param-sources"><span class="std std-ref">parameter sources</span></a>, create one directory per track. Then you can keep everything that is related to one track in one place. Remember that the track JSON file needs to be named <code class="docutils literal notranslate"><span class="pre">track.json</span></code>.</p></li>
<li><p>If you want to version your tracks so they can work with multiple versions of Elasticsearch (e.g. you are running benchmarks before an upgrade), use a track repository.</p></li>
</ul>
</div>
</div>
<div class="section" id="anatomy-of-a-track">
<h2>Anatomy of a track<a class="headerlink" href="#anatomy-of-a-track" title="Permalink to this headline">¶</a></h2>
<p>A track JSON file consists of the following sections:</p>
<ul class="simple">
<li><p>indices</p></li>
<li><p>templates</p></li>
<li><p>data-streams</p></li>
<li><p>composable-templates</p></li>
<li><p>component-templates</p></li>
<li><p>corpora</p></li>
<li><p>operations</p></li>
<li><p>schedule</p></li>
<li><p>challenges</p></li>
</ul>
<p>In the <code class="docutils literal notranslate"><span class="pre">indices</span></code> and <code class="docutils literal notranslate"><span class="pre">templates</span></code> sections you define the relevant indices and index templates. These sections are optional but recommended if you want to create indices and index templates with the help of Rally. The index templates here represent the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.9/indices-templates-v1.html">legacy Elasticsearch index templates</a> which have been deprecated in Elasticsearch 7.9. Users should refer to the <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> and <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> for new tracks.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section you define the relevant data streams. This section is optional but recommended if you want to create or delete data streams with the help of Rally. Data streams will often reference a composable template and require these to be inserted to Elasticsearch first.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> and <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> sections you define the relevant composable and component templates. Although optional, these will likely be required if data streams are being used.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">corpora</span></code> section you define all document corpora (i.e. data files) that Rally should use for this track.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">operations</span></code> section you describe which operations are available for this track and how they are parametrized. This section is optional and you can also define any operations directly per challenge. You can use it if you want to share operation definitions between challenges.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">schedule</span></code> section you describe the workload for the benchmark, for example index with two clients at maximum throughput while searching with another two clients with ten operations per second. The schedule either uses the operations defined in the <code class="docutils literal notranslate"><span class="pre">operations</span></code> block or defines the operations to execute inline.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">challenges</span></code> section you describe more than one set of operations, in the event your track needs to test more than one set of scenarios. This section is optional, and more information can be found in the <a class="reference internal" href="#track-challenge"><span class="std std-ref">challenges section</span></a>.</p>
<p>Creating a track does not require all of the above sections to be used. Tracks that are used against existing data may only rely on querying <code class="docutils literal notranslate"><span class="pre">operations</span></code> and can omit the <code class="docutils literal notranslate"><span class="pre">indices</span></code>, <code class="docutils literal notranslate"><span class="pre">templates</span></code>, and <code class="docutils literal notranslate"><span class="pre">corpora</span></code> sections. An example of this can be found in the <a class="reference internal" href="#track-single-task"><span class="std std-ref">task with a single track example</span></a>.</p>
</div>
<div class="section" id="track-elements">
<h2>Track elements<a class="headerlink" href="#track-elements" title="Permalink to this headline">¶</a></h2>
<p>The track elements that are described here are defined in <a class="reference external" href="https://github.com/elastic/rally/blob/master/esrally/resources/track-schema.json">Rally’s JSON schema for tracks</a>. Rally uses this track schema to validate your tracks when it is loading them.</p>
<p>Each track defines the following info attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">version</span></code> (optional): An integer describing the track specification version in use. Rally uses it to detect incompatible future track specification versions and raise an error. See the table below for a reference of valid versions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> (optional): A human-readable description of the track. Although it is optional, we recommend providing it.</p></li>
</ul>
<table class="docutils align-default">
<colgroup>
<col style="width: 61%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Track Specification Version</p></th>
<th class="head"><p>Rally version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>&gt;=0.7.3, &lt;0.10.0</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>&gt;=0.9.0</p></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">version</span></code> property has been introduced with Rally 0.7.3. Rally versions before 0.7.3 do not recognize this property and thus cannot detect incompatible track specification versions.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;POIs from Geonames&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="meta">
<h3>meta<a class="headerlink" href="#meta" title="Permalink to this headline">¶</a></h3>
<p>For each track, an optional structure, called <code class="docutils literal notranslate"><span class="pre">meta</span></code> can be defined. You are free which properties this element should contain.</p>
<p>This element can also be defined on the following elements:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">challenge</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operation</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code></p></li>
</ul>
<p>If the <code class="docutils literal notranslate"><span class="pre">meta</span></code> structure contains the same key on different elements, more specific ones will override the same key of more generic elements. The order from generic to most specific is:</p>
<ol class="arabic simple">
<li><p>track</p></li>
<li><p>challenge</p></li>
<li><p>operation</p></li>
<li><p>task</p></li>
</ol>
<p>E.g. a key defined on a task, will override the same key defined on a challenge. All properties defined within the merged <code class="docutils literal notranslate"><span class="pre">meta</span></code> structure, will get copied into each metrics record.</p>
</div>
<div class="section" id="indices">
<h3>indices<a class="headerlink" href="#indices" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">indices</span></code> section contains a list of all indices that are used by this track.  Cannot be used if the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section is specified.</p>
<p>Each index in this list consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): The name of the index.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (optional): File name of the corresponding index definition that will be used as body in the create index API call.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">types</span></code> (optional): A list of type names in this index. Types have been removed in Elasticsearch 7.0.0 so you must not specify this property if you want to benchmark Elasticsearch 7.0.0 or later.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;indices&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;geonames&quot;</span><span class="p">,</span>
      <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;geonames-index.json&quot;</span><span class="p">,</span>
      <span class="s2">&quot;types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;docs&quot;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="templates">
<h3>templates<a class="headerlink" href="#templates" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">templates</span></code> section contains a list of all index templates that Rally should create.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): Index template name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index-pattern</span></code> (mandatory): Index pattern that matches the index template. This must match the definition in the index template file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete-matching-indices</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Delete all indices that match the provided index pattern before start of the benchmark.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): Index template file name.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;templates&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-default-index-template&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index-pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;my-index-*&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delete-matching-indices&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;default-template.json&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="data-streams">
<h3>data-streams<a class="headerlink" href="#data-streams" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section contains a list of all data streams that are used by this track. Cannot be used if the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section is specified.</p>
<p>Each data stream in this list consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): The name of the data-stream.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;data-streams&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-logging-data-stream&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="composable-templates">
<h3>composable-templates<a class="headerlink" href="#composable-templates" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section contains a list of all composable templates that Rally should create. These composable templates will often reference component templates which should also be declared first using the <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section.</p>
<p>Each composable template in this list consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): Composable template name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index-pattern</span></code> (mandatory): Index pattern that matches the composable template. This must match the definition in the template file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete-matching-indices</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Delete all indices that match the provided index pattern if the template is deleted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): Composable template file name.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;composable-templates&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-default-composable-template&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index-pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;my-index-*&quot;</span><span class="p">,</span>
        <span class="s2">&quot;delete-matching-indices&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
        <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;composable-template.json&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="component-templates">
<h3>component-templates<a class="headerlink" href="#component-templates" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section contains a list of all component templates that Rally should create. These component templates will often be referenced by composable templates which can be declared using the <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section.</p>
<p>Each component template in this list consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): Component template name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): Component template file name.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;component-templates&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my-default-component-template&quot;</span><span class="p">,</span>
        <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;one-shard-template.json&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="corpora">
<h3>corpora<a class="headerlink" href="#corpora" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">corpora</span></code> section contains all document corpora that are used by this track. Note that you can reuse document corpora across tracks; just copy &amp; paste the respective corpora definitions. It consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): Name of this document corpus. As this name is also used by Rally in directory names, it is recommended to only use lower-case names without whitespaces for maximum compatibility across file systems.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">documents</span></code> (mandatory): A list of documents files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meta</span></code> (optional): A mapping of arbitrary key-value pairs with additional meta-data for a corpus.</p></li>
</ul>
<p>Each entry in the <code class="docutils literal notranslate"><span class="pre">documents</span></code> list consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base-url</span></code> (optional): A http(s), S3 or Google Storage URL that points to the root path where Rally can obtain the corresponding source file. Rally can also download data from private S3 or Google Storage buckets if access is properly configured:</p>
<ul>
<li><p>S3 according to <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/quickstart.html#configuration">docs</a>.</p></li>
<li><p>Google Storage: Either using <a class="reference external" href="https://cloud.google.com/storage/docs/reference/libraries#setting_up_authentication">client library authentication</a> or by presenting an <a class="reference external" href="https://cloud.google.com/storage/docs/authentication">oauth2 token</a> via the <code class="docutils literal notranslate"><span class="pre">GOOGLE_AUTH_TOKEN</span></code> environment variable, typically done using: <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">GOOGLE_AUTH_TOKEN=$(gcloud</span> <span class="pre">auth</span> <span class="pre">print-access-token)</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">source-format</span></code> (optional, default: <code class="docutils literal notranslate"><span class="pre">bulk</span></code>): Defines in which format Rally should interpret the data file specified by <code class="docutils literal notranslate"><span class="pre">source-file</span></code>. Currently, only <code class="docutils literal notranslate"><span class="pre">bulk</span></code> is supported.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source-file</span></code> (mandatory): File name of the corresponding documents. For local use, this file can be a <code class="docutils literal notranslate"><span class="pre">.json</span></code> file. If you provide a <code class="docutils literal notranslate"><span class="pre">base-url</span></code> we recommend that you provide a compressed file here. The following extensions are supported: <code class="docutils literal notranslate"><span class="pre">.zip</span></code>, <code class="docutils literal notranslate"><span class="pre">.bz2</span></code>, <code class="docutils literal notranslate"><span class="pre">.gz</span></code>, <code class="docutils literal notranslate"><span class="pre">.tar</span></code>, <code class="docutils literal notranslate"><span class="pre">.tar.gz</span></code>, <code class="docutils literal notranslate"><span class="pre">.tgz</span></code> or <code class="docutils literal notranslate"><span class="pre">.tar.bz2</span></code>. It must contain exactly one JSON file with the same name. The preferred file extension for our official tracks is <code class="docutils literal notranslate"><span class="pre">.bz2</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">includes-action-and-meta-data</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Defines whether the documents file contains already an action and meta-data line (<code class="docutils literal notranslate"><span class="pre">true</span></code>) or only documents (<code class="docutils literal notranslate"><span class="pre">false</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">document-count</span></code> (mandatory): Number of documents in the source file. This number is used by Rally to determine which client indexes which part of the document corpus (each of the N clients gets one N-th of the document corpus). If you are using parent-child, specify the number of parent documents.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compressed-bytes</span></code> (optional but recommended): The size in bytes of the compressed source file. This number is used to show users how much data will be downloaded by Rally and also to check whether the download is complete.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uncompressed-bytes</span></code> (optional but recommended): The size in bytes of the source file after decompression. This number is used by Rally to show users how much disk space the decompressed file will need and to check that the whole file could be decompressed successfully.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-index</span></code>: Defines the name of the index which should be targeted for bulk operations.  Rally will automatically derive this value if you have defined exactly one index in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section. Ignored if <code class="docutils literal notranslate"><span class="pre">includes-action-and-meta-data</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-type</span></code> (optional): Defines the name of the document type which should be targeted for bulk operations. Rally will automatically derive this value if you have defined exactly one index in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section and this index has exactly one type. Ignored if <code class="docutils literal notranslate"><span class="pre">includes-action-and-meta-data</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code> or if a <code class="docutils literal notranslate"><span class="pre">target-data-stream</span></code> is specified. Types have been removed in Elasticsearch 7.0.0 so you must not specify this property if you want to benchmark Elasticsearch 7.0.0 or later.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-data-stream</span></code>: Defines the name of the data stream which should be targeted for bulk operations.  Rally will automatically derive this value if you have defined exactly one index in the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section. Ignored if <code class="docutils literal notranslate"><span class="pre">includes-action-and-meta-data</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-index</span></code>: Defines the name of the index which should be targeted for bulk operations. Rally will automatically derive this value if you have defined exactly one index in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section. Ignored if <code class="docutils literal notranslate"><span class="pre">includes-action-and-meta-data</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-type</span></code> (optional): Defines the name of the document type which should be targeted for bulk operations. Rally will automatically derive this value if you have defined exactly one index in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section and this index has exactly one type. Ignored if <code class="docutils literal notranslate"><span class="pre">includes-action-and-meta-data</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>. Types have been removed in Elasticsearch 7.0.0 so you must not specify this property if you want to benchmark Elasticsearch 7.0.0 or later.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meta</span></code> (optional): A mapping of arbitrary key-value pairs with additional meta-data for a source file.</p></li>
</ul>
<p>To avoid repetition, you can specify default values on document corpus level for the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base-url</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">source-format</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">includes-action-and-meta-data</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-index</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-type</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-data-stream</span></code></p></li>
</ul>
<p>Examples</p>
<p>Here we define a single document corpus with one set of documents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;corpora&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;geonames&quot;</span><span class="p">,</span>
    <span class="s2">&quot;documents&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;base-url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://benchmarks.elasticsearch.org.s3.amazonaws.com/corpora/geonames&quot;</span><span class="p">,</span>
        <span class="s2">&quot;source-file&quot;</span><span class="p">:</span> <span class="s2">&quot;documents.json.bz2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;document-count&quot;</span><span class="p">:</span> <span class="mi">11396505</span><span class="p">,</span>
        <span class="s2">&quot;compressed-bytes&quot;</span><span class="p">:</span> <span class="mi">264698741</span><span class="p">,</span>
        <span class="s2">&quot;uncompressed-bytes&quot;</span><span class="p">:</span> <span class="mi">3547614383</span><span class="p">,</span>
        <span class="s2">&quot;target-index&quot;</span><span class="p">:</span> <span class="s2">&quot;geonames&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target-type&quot;</span><span class="p">:</span> <span class="s2">&quot;docs&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Here we define a single document corpus with one set of documents using data streams instead of indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;corpora&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http_logs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;documents&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;base-url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://benchmarks.elasticsearch.org.s3.amazonaws.com/corpora/http_logs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;source-file&quot;</span><span class="p">:</span> <span class="s2">&quot;documents-181998.json.bz2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;document-count&quot;</span><span class="p">:</span> <span class="mi">2708746</span><span class="p">,</span>
        <span class="s2">&quot;target-data-stream&quot;</span><span class="p">:</span> <span class="s2">&quot;my-logging-data-stream&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>We can also define default values on document corpus level but override some of them (<code class="docutils literal notranslate"><span class="pre">base-url</span></code> for the last entry):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;corpora&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http_logs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;base-url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://benchmarks.elasticsearch.org.s3.amazonaws.com/corpora/http_logs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;target-type&quot;</span><span class="p">:</span> <span class="s2">&quot;docs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;documents&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;source-file&quot;</span><span class="p">:</span> <span class="s2">&quot;documents-181998.json.bz2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;document-count&quot;</span><span class="p">:</span> <span class="mi">2708746</span><span class="p">,</span>
        <span class="s2">&quot;target-index&quot;</span><span class="p">:</span> <span class="s2">&quot;logs-181998&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;source-file&quot;</span><span class="p">:</span> <span class="s2">&quot;documents-191998.json.bz2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;document-count&quot;</span><span class="p">:</span> <span class="mi">9697882</span><span class="p">,</span>
        <span class="s2">&quot;target-index&quot;</span><span class="p">:</span> <span class="s2">&quot;logs-191998&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;base-url&quot;</span><span class="p">:</span> <span class="s2">&quot;http://example.org/corpora/http_logs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;source-file&quot;</span><span class="p">:</span> <span class="s2">&quot;documents-201998.json.bz2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;document-count&quot;</span><span class="p">:</span> <span class="mi">13053463</span><span class="p">,</span>
        <span class="s2">&quot;target-index&quot;</span><span class="p">:</span> <span class="s2">&quot;logs-201998&quot;</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="challenge">
<span id="track-challenge"></span><h3>challenge<a class="headerlink" href="#challenge" title="Permalink to this headline">¶</a></h3>
<p>If your track defines only one benchmarking scenario specify the <code class="docutils literal notranslate"><span class="pre">schedule</span></code> on top-level. Use the <code class="docutils literal notranslate"><span class="pre">challenge</span></code> element if you want to specify additional properties like a name or a description. You can think of a challenge as a benchmarking scenario. If you have multiple challenges, you can define an array of <code class="docutils literal notranslate"><span class="pre">challenges</span></code>.</p>
<p>This section contains one or more challenges which describe the benchmark scenarios for this data set. A challenge can reference all operations that are defined in the <code class="docutils literal notranslate"><span class="pre">operations</span></code> section.</p>
<p>Each challenge consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): A descriptive name of the challenge. Should not contain spaces in order to simplify handling on the command line for users.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> (optional): A human readable description of the challenge.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default</span></code> (optional): If true, Rally selects this challenge by default if the user did not specify a challenge on the command line. If your track only defines one challenge, it is implicitly selected as default, otherwise you need to define <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;:</span> <span class="pre">true</span></code> on exactly one challenge.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schedule</span></code> (mandatory): Defines the workload. It is described in more detail below.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should strive to minimize the number of challenges. If you just want to run a subset of the tasks in a challenge, use <a class="reference internal" href="command_line_reference.html#clr-include-tasks"><span class="std std-ref">task filtering</span></a>.</p>
</div>
</div>
<div class="section" id="schedule">
<h3>schedule<a class="headerlink" href="#schedule" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">schedule</span></code> element contains a list of tasks that are executed by Rally, i.e. it describes the workload. Each task consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (optional): This property defines an explicit name for the given task. By default the operation’s name is implicitly used as the task name but if the same operation is run multiple times, a unique task name must be specified using this property.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operation</span></code> (mandatory): This property refers either to the name of an operation that has been defined in the <code class="docutils literal notranslate"><span class="pre">operations</span></code> section or directly defines an operation inline.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">clients</span></code> (optional, defaults to 1): The number of clients that should execute a task concurrently.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warmup-iterations</span></code> (optional, defaults to 0): Number of iterations that each client should execute to warmup the benchmark candidate. Warmup iterations will not show up in the measurement results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iterations</span></code> (optional, defaults to 1): Number of measurement iterations that each client executes. The command line report will automatically adjust the percentile numbers based on this number (i.e. if you just run 5 iterations you will not get a 99.9th percentile because we need at least 1000 iterations to determine this value precisely).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warmup-time-period</span></code> (optional, defaults to 0): A time period in seconds that Rally considers for warmup of the benchmark candidate. All response data captured during warmup will not show up in the measurement results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time-period</span></code> (optional): A time period in seconds that Rally considers for measurement. Note that for bulk indexing you should usually not define this time period. Rally will just bulk index all documents and consider every sample after the warmup time period as measurement sample.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">schedule</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">deterministic</span></code>): Defines the schedule for this task, i.e. it defines at which point in time during the benchmark an operation should be executed. For example, if you specify a <code class="docutils literal notranslate"><span class="pre">deterministic</span></code> schedule and a target-interval of 5 (seconds), Rally will attempt to execute the corresponding operation at second 0, 5, 10, 15 … . Out of the box, Rally supports <code class="docutils literal notranslate"><span class="pre">deterministic</span></code> and <code class="docutils literal notranslate"><span class="pre">poisson</span></code> but you can define your own <a class="reference internal" href="adding_tracks.html"><span class="doc">custom schedules</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-throughput</span></code> (optional): Defines the benchmark mode. If it is not defined, Rally assumes this is a throughput benchmark and will run the task as fast as it can. This is mostly needed for batch-style operations where it is more important to achieve the best throughput instead of an acceptable latency. If it is defined, it specifies the number of requests per second over all clients. E.g. if you specify <code class="docutils literal notranslate"><span class="pre">target-throughput:</span> <span class="pre">1000</span></code> with 8 clients, it means that each client will issue 125 (= 1000 / 8) requests per second. In total, all clients will issue 1000 requests each second. If Rally reports less than the specified throughput then Elasticsearch simply cannot reach it.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-interval</span></code> (optional): This is just <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">target-throughput</span></code> (in seconds) and may be more convenient for cases where the throughput is less than one operation per second. Define either <code class="docutils literal notranslate"><span class="pre">target-throughput</span></code> or <code class="docutils literal notranslate"><span class="pre">target-interval</span></code> but not both (otherwise Rally will raise an error).</p></li>
</ul>
<div class="section" id="defining-operations">
<h4>Defining operations<a class="headerlink" href="#defining-operations" title="Permalink to this headline">¶</a></h4>
<p>In the following snippet we define two operations <code class="docutils literal notranslate"><span class="pre">force-merge</span></code> and a <code class="docutils literal notranslate"><span class="pre">match-all</span></code> query separately in an operations block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;operations&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;force-merge&quot;</span><span class="p">,</span>
      <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;force-merge&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;match-all-query&quot;</span><span class="p">,</span>
      <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;search&quot;</span><span class="p">,</span>
      <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;match_all&quot;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;force-merge&quot;</span><span class="p">,</span>
      <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;match-all-query&quot;</span><span class="p">,</span>
      <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">100</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we do not want to reuse these operations, we can also define them inline. Note that the <code class="docutils literal notranslate"><span class="pre">operations</span></code> section is gone:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;force-merge&quot;</span><span class="p">,</span>
        <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;force-merge&quot;</span>
      <span class="p">},</span>
      <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;match-all-query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;search&quot;</span><span class="p">,</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;match_all&quot;</span><span class="p">:</span> <span class="p">{}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">100</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Contrary to the <code class="docutils literal notranslate"><span class="pre">query</span></code>, the <code class="docutils literal notranslate"><span class="pre">force-merge</span></code> operation does not take any parameters, so Rally allows us to just specify the <code class="docutils literal notranslate"><span class="pre">operation-type</span></code> for this operation. Its name will be the same as the operation’s type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;force-merge&quot;</span><span class="p">,</span>
      <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;match-all-query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;search&quot;</span><span class="p">,</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;match_all&quot;</span><span class="p">:</span> <span class="p">{}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
      <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
      <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">100</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="choosing-a-schedule">
<span id="track-choose-schedule"></span><h4>Choosing a schedule<a class="headerlink" href="#choosing-a-schedule" title="Permalink to this headline">¶</a></h4>
<p>Rally allows you to choose between the following schedules to simulate traffic:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Degenerate_distribution">deterministically distributed</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson distributed</a></p></li>
</ul>
<p>The diagram below shows how different schedules in Rally behave during the first ten seconds of a benchmark. Each schedule is configured for a (mean) target throughput of one operation per second.</p>
<img alt="Comparison of Scheduling Strategies in Rally" src="_images/schedulers_10s.png" />
<p>If you want as much reproducibility as possible you can choose the <cite>deterministic</cite> schedule. A Poisson distribution models random independent arrivals of clients which on average match the expected arrival rate which makes it suitable for modelling the behaviour of multiple clients that decide independently when to issue a request. For this reason, Poisson processes play an important role in <a class="reference external" href="https://en.wikipedia.org/wiki/Queueing_theory">queueing theory</a>.</p>
<p>If you have more complex needs on how to model traffic, you can also implement a <a class="reference internal" href="adding_tracks.html"><span class="doc">custom schedule</span></a>.</p>
</div>
<div class="section" id="time-based-vs-iteration-based">
<h4>Time-based vs. iteration-based<a class="headerlink" href="#time-based-vs-iteration-based" title="Permalink to this headline">¶</a></h4>
<p>You should usually use time periods for batch style operations and iterations for the rest. However, you can also choose to run a query for a certain time period.</p>
<p>All tasks in the <code class="docutils literal notranslate"><span class="pre">schedule</span></code> list are executed sequentially in the order in which they have been defined. However, it is also possible to execute multiple tasks concurrently, by wrapping them in a <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element. The <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element defines of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">clients</span></code> (optional): The number of clients that should execute the provided tasks. If you specify this property, Rally will only use as many clients as you have defined on the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element (see examples)!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warmup-time-period</span></code> (optional, defaults to 0): Allows to define a default value for all tasks of the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">time-period</span></code> (optional, no default value if not specified): Allows to define a default value for all tasks of the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">warmup-iterations</span></code> (optional, defaults to 0): Allows to define a default value for all tasks of the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iterations</span></code> (optional, defaults to 1): Allows to define a default value for all tasks of the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">completed-by</span></code> (optional): Allows to define the name of one task in the <code class="docutils literal notranslate"><span class="pre">tasks</span></code> list. As soon as this task has completed, the whole <code class="docutils literal notranslate"><span class="pre">parallel</span></code> task structure is considered completed. If this property is not explicitly defined, the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> task structure is considered completed as soon as all its subtasks have completed. A task is completed if and only if all associated clients have completed execution.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tasks</span></code> (mandatory): Defines a list of tasks that should be executed concurrently. Each task in the list can define the following properties that have been defined above: <code class="docutils literal notranslate"><span class="pre">clients</span></code>, <code class="docutils literal notranslate"><span class="pre">warmup-time-period</span></code>, <code class="docutils literal notranslate"><span class="pre">time-period</span></code>, <code class="docutils literal notranslate"><span class="pre">warmup-iterations</span></code> and <code class="docutils literal notranslate"><span class="pre">iterations</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">parallel</span></code> elements cannot be nested.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Specify the number of clients on each task separately. If you specify this number on the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element instead, Rally will only use that many clients in total and you will only want to use this behavior in very rare cases (see examples)!</p>
</div>
</div>
</div>
<div class="section" id="operations">
<span id="track-operations"></span><h3>operations<a class="headerlink" href="#operations" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">operations</span></code> section contains a list of all operations that are available when specifying a schedule. Operations define the static properties of a request against Elasticsearch whereas the <code class="docutils literal notranslate"><span class="pre">schedule</span></code> element defines the dynamic properties (such as the target throughput).</p>
<p>Each operation consists of the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): The name of this operation. You can choose this name freely. It is only needed to reference the operation when defining schedules.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operation-type</span></code> (mandatory): Type of this operation. See below for the operation types that are supported out of the box in Rally. You can also add arbitrary operations by defining <a class="reference internal" href="adding_tracks.html"><span class="doc">custom runners</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code> for normal operations and to <code class="docutils literal notranslate"><span class="pre">false</span></code> for administrative operations): Whether or not this operation should be included in the command line report. For example you might want Rally to create an index for you but you are not interested in detailed metrics about it. Note that Rally will still record all metrics in the metrics store.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-timeout</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>): The client-side timeout for this operation.  Represented as a floating-point number in seconds, e.g. <code class="docutils literal notranslate"><span class="pre">1.5</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">headers</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>): A dictionary of key-value pairs to pass as headers in the operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opaque-id</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> [unused]): A special ID set as the value of <code class="docutils literal notranslate"><span class="pre">x-opaque-id</span></code> in the client headers of the operation.  Overrides existing <code class="docutils literal notranslate"><span class="pre">x-opaque-id</span></code> entries in <code class="docutils literal notranslate"><span class="pre">headers</span></code> (case-insensitive).</p></li>
</ul>
<p>Some of the operations below are also retryable (marked accordingly below). Retryable operations expose the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">retries</span></code> (optional, defaults to 0): The number of times the operation is retried.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">retry-until-success</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Retries until the operation returns a success. This will also forcibly set <code class="docutils literal notranslate"><span class="pre">retry-on-error</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">retry-wait-period</span></code> (optional, defaults to 0.5): The time in seconds to wait between retry attempts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">retry-on-timeout</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Whether to retry on connection timeout.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">retry-on-error</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Whether to retry on errors (e.g. when an index could not be deleted).</p></li>
</ul>
<p>Depending on the operation type a couple of further parameters can be specified.</p>
<div class="section" id="bulk">
<h4>bulk<a class="headerlink" href="#bulk" title="Permalink to this headline">¶</a></h4>
<p>With the operation type <code class="docutils literal notranslate"><span class="pre">bulk</span></code> you can execute <a class="reference external" href="http://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html">bulk requests</a>. It supports the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bulk-size</span></code> (mandatory): Defines the bulk size in number of documents.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ingest-percentage</span></code> (optional, defaults to 100): A number between (0, 100] that defines how much of the document corpus will be bulk-indexed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">corpora</span></code> (optional): A list of document corpus names that should be targeted by this bulk-index operation. Only needed if the <code class="docutils literal notranslate"><span class="pre">corpora</span></code> section contains more than one document corpus and you don’t want to index all of them with this operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">indices</span></code> (optional): A list of index names that defines which indices should be used by this bulk-index operation. Rally will then only select the documents files that have a matching <code class="docutils literal notranslate"><span class="pre">target-index</span></code> specified.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">batch-size</span></code> (optional): Defines how many documents Rally will read at once. This is an expert setting and only meant to avoid accidental bottlenecks for very small bulk sizes (e.g. if you want to benchmark with a bulk-size of 1, you should set <code class="docutils literal notranslate"><span class="pre">batch-size</span></code> higher).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pipeline</span></code> (optional): Defines the name of an (existing) ingest pipeline that should be used (only supported from Elasticsearch 5.0).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conflicts</span></code> (optional): Type of index conflicts to simulate. If not specified, no conflicts will be simulated (also read below on how to use external index ids with no conflicts). Valid values are: ‘sequential’ (A document id is replaced with a document id with a sequentially increasing id), ‘random’ (A document id is replaced with a document id with a random other id).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conflict-probability</span></code> (optional, defaults to 25 percent): A number between [0, 100] that defines how many of the documents will get replaced. Combining <code class="docutils literal notranslate"><span class="pre">conflicts=sequential</span></code> and <code class="docutils literal notranslate"><span class="pre">conflict-probability=0</span></code> makes Rally generate index ids by itself, instead of relying on Elasticsearch’s <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html#_automatic_id_generation">automatic id generation</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">on-conflict</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">index</span></code>): Determines whether Rally should use the action <code class="docutils literal notranslate"><span class="pre">index</span></code> or <code class="docutils literal notranslate"><span class="pre">update</span></code> on id conflicts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">recency</span></code> (optional, defaults to 0): A number between [0,1] indicating whether to bias conflicting ids towards more recent ids (<code class="docutils literal notranslate"><span class="pre">recency</span></code> towards 1) or whether to consider all ids for id conflicts (<code class="docutils literal notranslate"><span class="pre">recency</span></code> towards 0). See the diagram below for details.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detailed-results</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Records more detailed meta-data for bulk requests. As it analyzes the corresponding bulk response in more detail, this might incur additional overhead which can skew measurement results.</p></li>
</ul>
<p>The image below shows how Rally behaves with a <code class="docutils literal notranslate"><span class="pre">recency</span></code> set to 0.5. Internally, Rally uses the blue function for its calculations but to understand the behavior we will focus on red function (which is just the inverse). Suppose we have already generated ids from 1 to 100 and we are about to simulate an id conflict. Rally will randomly choose a value on the y-axis, e.g. 0.8 which is mapped to 0.1 on the x-axis. This means that in 80% of all cases, Rally will choose an id within the most recent 10%, i.e. between 90 and 100. With 20% probability the id will be between 1 and 89. The closer <code class="docutils literal notranslate"><span class="pre">recency</span></code> gets to zero, the “flatter” the red curve gets and the more likely Rally will choose less recent ids.</p>
<img alt="Recency Function" src="_images/recency.png" />
<p>You can also <a class="reference external" href="https://www.desmos.com/calculator/zlzieypanv">explore the recency calculation interactively</a>.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;index-append&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;bulk&quot;</span><span class="p">,</span>
  <span class="s2">&quot;bulk-size&quot;</span><span class="p">:</span> <span class="mi">5000</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Throughput will be reported as number of indexed documents per second.</p>
</div>
<div class="section" id="force-merge">
<h4>force-merge<a class="headerlink" href="#force-merge" title="Permalink to this headline">¶</a></h4>
<p>With the operation type <code class="docutils literal notranslate"><span class="pre">force-merge</span></code> you can call the <a class="reference external" href="http://www.elastic.co/guide/en/elasticsearch/reference/current/indices-forcemerge.html">force merge API</a>. On older versions of Elasticsearch (prior to 2.1), Rally will use the <code class="docutils literal notranslate"><span class="pre">optimize</span> <span class="pre">API</span></code> instead. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (optional, defaults to the indices defined in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section or the data streams defined in the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section. If neither are defined defaults to <code class="docutils literal notranslate"><span class="pre">_all</span></code>.): The name of the index or data stream that should be force-merged.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code> (optional, default to <code class="docutils literal notranslate"><span class="pre">blocking</span></code>): In the default <code class="docutils literal notranslate"><span class="pre">blocking</span></code> mode the Elasticsearch client blocks until the operation returns or times out as dictated by the <a class="reference internal" href="command_line_reference.html#clr-client-options"><span class="std std-ref">client-options</span></a>. In mode <cite>polling</cite> the client timeout is ignored. Instead, the api call is given 1s to complete. If the operation has not finished, the operator will poll every <code class="docutils literal notranslate"><span class="pre">poll-period</span></code> until all force merges are complete.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">poll-period</span></code> (defaults to 10s): Only applicable if <code class="docutils literal notranslate"><span class="pre">mode</span></code> is set to <code class="docutils literal notranslate"><span class="pre">polling</span></code>. Determines the internal at which a check is performed that all force merge operations are complete.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max-num-segments</span></code> (optional)  The number of segments the index should be merged into. Defaults to simply checking if a merge needs to execute, and if so, executes it.</p></li>
</ul>
<p>This is an administrative operation. Metrics are not reported by default. If reporting is forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>, then throughput is reported as the number of completed force-merge operations per second.</p>
</div>
<div class="section" id="index-stats">
<h4>index-stats<a class="headerlink" href="#index-stats" title="Permalink to this headline">¶</a></h4>
<p>With the operation type <code class="docutils literal notranslate"><span class="pre">index-stats</span></code> you can call the <a class="reference external" href="http://www.elastic.co/guide/en/elasticsearch/reference/current/indices-stats.html">indices stats API</a>. It supports the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (optional, defaults to <cite>_all</cite>): An <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/multi-index.html">index pattern</a> that defines which indices should be targeted by this operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">condition</span></code> (optional, defaults to no condition): A structured object with the properties <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">expected-value</span></code>. If the actual value returned by indices stats API is equal to the expected value at the provided path, this operation will return successfully. See below for an example how this can be used.</p></li>
</ul>
<p>In the following example the <code class="docutils literal notranslate"><span class="pre">index-stats</span></code> operation will wait until all segments have been merged:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;index-stats&quot;</span><span class="p">,</span>
    <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;_all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;condition&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;_all.total.merges.current&quot;</span><span class="p">,</span>
        <span class="s2">&quot;expected-value&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="s2">&quot;retry-until-success&quot;</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Throughput will be reported as number of completed <cite>index-stats</cite> operations per second.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="node-stats">
<h4>node-stats<a class="headerlink" href="#node-stats" title="Permalink to this headline">¶</a></h4>
<p>With the operation type <code class="docutils literal notranslate"><span class="pre">nodes-stats</span></code> you can execute <a class="reference external" href="http://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html">nodes stats API</a>. It does not support any parameters.</p>
<p>Throughput will be reported as number of completed <cite>node-stats</cite> operations per second.</p>
</div>
<div class="section" id="search">
<h4>search<a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h4>
<p>With the operation type <code class="docutils literal notranslate"><span class="pre">search</span></code> you can execute <a class="reference external" href="http://www.elastic.co/guide/en/elasticsearch/reference/current/search-search.html">request body searches</a>. It supports the following properties:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (optional): An <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/multi-index.html">index pattern</a> that defines which indices or data streams should be targeted by this query. Only needed if the <code class="docutils literal notranslate"><span class="pre">indices</span></code> or <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section contains more than one index or data stream respectively. Otherwise, Rally will automatically derive the index or data stream to use. If you have defined multiple indices or data streams and want to query all of them, just specify <code class="docutils literal notranslate"><span class="pre">&quot;index&quot;:</span> <span class="pre">&quot;_all&quot;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> (optional): Defines the type within the specified index for this query. By default, no <code class="docutils literal notranslate"><span class="pre">type</span></code> will be used and the query will be performed across all types in the provided index. Also, types have been removed in Elasticsearch 7.0.0 so you must not specify this property if you want to benchmark Elasticsearch 7.0.0 or later.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cache</span></code> (optional): Whether to use the query request cache. By default, Rally will define no value thus the default depends on the benchmark candidate settings and Elasticsearch version.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing arbitrary request parameters. The supported parameters names are documented in the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/search-uri-request.html#_parameters_3">Search URI Request docs</a>.</p>
<blockquote>
<div><div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Parameters that are implicitly set by Rally (e.g. <cite>body</cite> or <cite>request_cache</cite>) are not supported (i.e. you should not try to set them and if so expect unspecified behavior).</p></li>
<li><p>Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ol>
</div>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): The query body.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">response-compression-enabled</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Allows to disable HTTP compression of responses. As these responses are sometimes large and decompression may be a bottleneck on the client, it is possible to turn off response compression.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detailed-results</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Records more detailed meta-data about queries. As it analyzes the corresponding response in more detail, this might incur additional overhead which can skew measurement results. This flag is ineffective for scroll queries.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pages</span></code> (optional): Number of pages to retrieve. If this parameter is present, a scroll query will be executed. If you want to retrieve all result pages, use the value “all”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">results-per-page</span></code> (optional):  Number of documents to retrieve per page for scroll queries.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">detailed-results</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, the following meta-data properties will be determined and stored:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hits</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hits_relation</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timed_out</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">took</span></code></p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;search&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;match_all&quot;</span><span class="p">:</span> <span class="p">{}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;_source_include&quot;</span><span class="p">:</span> <span class="s2">&quot;some_field&quot;</span><span class="p">,</span>
    <span class="s2">&quot;analyze_wildcard&quot;</span><span class="p">:</span> <span class="s2">&quot;false&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For scroll queries, throughput will be reported as number of retrieved scroll pages per second. The unit is ops/s, where one op(eration) is one page that has been retrieved. The rationale is that each HTTP request corresponds to one operation and we need to issue one HTTP request per result page. Note that if you use a dedicated Elasticsearch metrics store, you can also use other request-level meta-data such as the number of hits for your own analyses.</p>
<p>For other queries, throughput will be reported as number of search requests per second, also measured as ops/s.</p>
</div>
<div class="section" id="put-pipeline">
<span id="id2"></span><h4>put-pipeline<a class="headerlink" href="#put-pipeline" title="Permalink to this headline">¶</a></h4>
<p>With the operation-type <code class="docutils literal notranslate"><span class="pre">put-pipeline</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/put-pipeline-api.html">put pipeline API</a>. Note that this API is only available from Elasticsearch 5.0 onwards. It supports the following properties:</p>
<ul class="simple">
<li><p><cite>id</cite> (mandatory): Pipeline id.</p></li>
<li><p><cite>body</cite> (mandatory): Pipeline definition.</p></li>
</ul>
<p>In this example we setup a pipeline that adds location information to a ingested document as well as a pipeline failure block to change the index in which the document was supposed to be written. Note that we need to use the <code class="docutils literal notranslate"><span class="pre">raw</span></code> and <code class="docutils literal notranslate"><span class="pre">endraw</span></code> blocks to ensure that Rally does not attempt to resolve the Mustache template. See <a class="reference internal" href="adding_tracks.html#template-language"><span class="std std-ref">template language</span></a> for more information.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;define-ip-geocoder&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;put-pipeline&quot;</span><span class="p">,</span>
  <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ip-geocoder&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Extracts location information from the client IP.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;processors&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;geoip&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;clientip&quot;</span><span class="p">,</span>
          <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;city_name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;country_iso_code&quot;</span><span class="p">,</span>
            <span class="s2">&quot;country_name&quot;</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span>
          <span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;on_failure&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;set&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="s2">&quot;_index&quot;</span><span class="p">,</span>
          <span class="p">{</span><span class="o">%</span> <span class="n">raw</span> <span class="o">%</span><span class="p">}</span>
          <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;failed-{{ _index }}&quot;</span>
          <span class="p">{</span><span class="o">%</span> <span class="n">endraw</span> <span class="o">%</span><span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Please see <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/handling-failure-in-pipelines.html">the pipeline documentation</a> for details on handling failures in pipelines.</p>
<p>This example requires that the <code class="docutils literal notranslate"><span class="pre">ingest-geoip</span></code> Elasticsearch plugin is installed.</p>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="put-settings">
<h4>put-settings<a class="headerlink" href="#put-settings" title="Permalink to this headline">¶</a></h4>
<p>With the operation-type <code class="docutils literal notranslate"><span class="pre">put-settings</span></code> you can execute the <a class="reference external" href="http://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-update-settings.html">cluster update settings API</a>. It supports the following properties:</p>
<ul class="simple">
<li><p><cite>body</cite> (mandatory): The cluster settings to apply.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;increase-watermarks&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;put-settings&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;transient&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;cluster.routing.allocation.disk.watermark.low&quot;</span> <span class="p">:</span> <span class="s2">&quot;95%&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cluster.routing.allocation.disk.watermark.high&quot;</span> <span class="p">:</span> <span class="s2">&quot;97%&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cluster.routing.allocation.disk.watermark.flood_stage&quot;</span> <span class="p">:</span> <span class="s2">&quot;99%&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="cluster-health">
<h4>cluster-health<a class="headerlink" href="#cluster-health" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">cluster-health</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-health.html">cluster health API</a>. It supports the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the cluster health API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (optional): The name of the index that should be used to check.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">cluster-health</span></code> operation will check whether the expected cluster health and will report a failure if this is not the case. Use <code class="docutils literal notranslate"><span class="pre">--on-error</span></code> on the command line to control Rally’s behavior in case of such failures.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;check-cluster-green&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;cluster-health&quot;</span><span class="p">,</span>
  <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;logs-*&quot;</span><span class="p">,</span>
  <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;wait_for_status&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
    <span class="s2">&quot;wait_for_no_relocating_shards&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
  <span class="p">},</span>
  <span class="s2">&quot;retry-until-success&quot;</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="refresh">
<h4>refresh<a class="headerlink" href="#refresh" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">refresh</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-refresh.html">refresh API</a>. It supports the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">_all</span></code>): The name of the index or data stream that should be refreshed.</p></li>
</ul>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-index">
<h4>create-index<a class="headerlink" href="#create-index" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-index</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-create-index.html">create index API</a>. It supports two modes: it creates either all indices that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">indices</span></code> section or it creates one specific index defined by this operation.</p>
<p>If you want it to create all indices that have been declared in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">settings</span></code> (optional): Allows to specify additional index settings that will be merged with the index settings specified in the body of the index in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create index API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p>If you want it to create one specific index instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (mandatory): One or more names of the indices that should be created. If only one index should be created, you can use a string otherwise this needs to be a list of strings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (optional): The body for the create index API call.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create index API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>The following snippet will create all indices that have been defined in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section. It will reuse all settings defined but override the number of shards:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-all-indices&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-index&quot;</span><span class="p">,</span>
  <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;index.number_of_shards&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">},</span>
  <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will create a new index that is not defined in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section. Note that we specify the index settings directly in the body:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-an-index&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-index&quot;</span><span class="p">,</span>
  <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;people&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;index.number_of_shards&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="s2">&quot;mappings&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;docs&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;text&quot;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Types have been removed in Elasticsearch 7.0.0. If you want to benchmark Elasticsearch 7.0.0 or later you need to remove the mapping type above.</p>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="delete-index">
<h4>delete-index<a class="headerlink" href="#delete-index" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-index</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-delete-index.html">delete index API</a>. It supports two modes: it deletes either all indices that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">indices</span></code> section or it deletes one specific index (pattern) defined by this operation.</p>
<p>If you want it to delete all indices that have been declared in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether an index should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete index API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p>If you want it to delete one specific index (pattern) instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (mandatory): One or more names of the indices that should be deleted. If only one index should be deleted, you can use a string otherwise this needs to be a list of strings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether an index should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete index API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>With the following snippet we will delete all indices that are declared in the <code class="docutils literal notranslate"><span class="pre">indices</span></code> section but only if they existed previously (implicit default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-all-indices&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-index&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will delete all <code class="docutils literal notranslate"><span class="pre">logs-*</span></code> indices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-logs&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-index&quot;</span><span class="p">,</span>
  <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;logs-*&quot;</span><span class="p">,</span>
  <span class="s2">&quot;only-if-exists&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
  <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;expand_wildcards&quot;</span><span class="p">:</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span>
    <span class="s2">&quot;allow_no_indices&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ignore_unavailable&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-data-stream">
<h4>create-data-stream<a class="headerlink" href="#create-data-stream" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-data-stream</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-create-data-stream.html">create data stream API</a>. It supports two modes: it creates either all data streams that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section or it creates one specific data stream defined by this operation.</p>
<p>If you want it to create all data streams that have been declared in the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create data stream API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p>If you want it to create one specific data stream instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data-stream</span></code> (mandatory): One or more names of the data streams that should be created. If only one data stream should be created, you can use a string otherwise this needs to be a list of strings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create index API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>The following snippet will create all data streams that have been defined in the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-all-data-streams&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-data-stream&quot;</span><span class="p">,</span>
  <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;wait_for_active_shards&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will create a new data stream that is not defined in the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-a-data-stream&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-data-stream&quot;</span><span class="p">,</span>
  <span class="s2">&quot;data-stream&quot;</span><span class="p">:</span> <span class="s2">&quot;people&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="delete-data-stream">
<h4>delete-data-stream<a class="headerlink" href="#delete-data-stream" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-data-stream</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-delete-data-stream.html">delete data stream API</a>. It supports two modes: it deletes either all data streams that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section or it deletes one specific data stream (pattern) defined by this operation.</p>
<p>If you want it to delete all data streams that have been declared in the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether a data stream should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete index API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p>If you want it to delete one specific data stream (pattern) instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data-stream</span></code> (mandatory): One or more names of the data streams that should be deleted. If only one data stream should be deleted, you can use a string otherwise this needs to be a list of strings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether a data stream should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete data stream API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>With the following snippet we will delete all data streams that are declared in the <code class="docutils literal notranslate"><span class="pre">data-streams</span></code> section but only if they existed previously (implicit default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-all-data-streams&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-data-stream&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will delete all <code class="docutils literal notranslate"><span class="pre">ds-logs-*</span></code> data streams:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-data-streams&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-data-stream&quot;</span><span class="p">,</span>
  <span class="s2">&quot;data-stream&quot;</span><span class="p">:</span> <span class="s2">&quot;ds-logs-*&quot;</span><span class="p">,</span>
  <span class="s2">&quot;only-if-exists&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-composable-template">
<h4>create-composable-template<a class="headerlink" href="#create-composable-template" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-composable-template</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-put-template.html">create index template API</a>. It supports two modes: it creates either all templates that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section or it creates one specific template defined by this operation.</p>
<p>If you want it to create templates that have been declared in the <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (optional): If you specify a template name, only the template with this name will be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">settings</span></code> (optional): Allows to specify additional settings that will be merged with the settings specified in the body of the template in the <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p>If you want it to create one specific template instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): The name of the template that should be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): The body for the create template API call.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create index template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>The following snippet will create all index templates that have been defined in the <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-all-templates&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-composable-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;create&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will create a new index template that is not defined in the <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section. Note that we specify the index template settings directly in the body:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-a-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-composable-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;logs&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;index_patterns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
    <span class="s2">&quot;composed_of&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;component_template_with_2_shards&quot;</span><span class="p">,</span> <span class="s2">&quot;component_template_with_3_shards&quot;</span><span class="p">],</span>
    <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;mappings&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your composable template references component templates, such as in the example above, ensure these are created first using the <code class="docutils literal notranslate"><span class="pre">create-component-template</span></code> operation.</p>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-component-template">
<h4>create-component-template<a class="headerlink" href="#create-component-template" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-component-template</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-component-template.html">create component template API</a>. It supports two modes: it creates either all component templates that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section or it creates one specific component template defined by this operation.</p>
<p>If you want it to create templates that have been declared in the <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (optional): If you specify a template name, only the component template with this name will be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">settings</span></code> (optional): Allows to specify additional settings that will be merged with the settings specified in the body of the component template in the <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create component template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p>If you want it to create one specific template instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): The name of the template that should be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): The body for the create template API call.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create component template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>The following snippet will create all component templates that have been defined in the <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-all-templates&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-component-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;create&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will create a new component template that is not defined in the <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section. Note that we specify the component template settings directly in the body:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-a-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-composable-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;component_template_with_2_shards&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;number_of_shards&quot;</span><span class="p">:</span> <span class="mi">2</span>
      <span class="p">},</span>
      <span class="s2">&quot;mappings&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If your component template is used in composable templates, ensure these are created after specifying this operation using the <code class="docutils literal notranslate"><span class="pre">create-composable-template</span></code> operation.</p>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-index-template">
<h4>create-index-template<a class="headerlink" href="#create-index-template" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-index-template</span></code> you can execute the deprecated <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-templates.html">create template API</a>. It supports two modes: it creates either all index templates that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">templates</span></code> section or it creates one specific index template defined by this operation.</p>
<p>If you want it to create index templates that have been declared in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> section you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (optional): If you specify a template name, only the template with this name will be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">settings</span></code> (optional): Allows to specify additional settings that will be merged with the settings specified in the body of the index template in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> section.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p>If you want it to create one specific index template instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): The name of the index template that should be created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): The body for the create template API call.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the create template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters (see example below).</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>The following snippet will create all index templates that have been defined in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-all-templates&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-index-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;create&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will create a new index template that is not defined in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> section. Note that we specify the index template settings directly in the body:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;create-a-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;create-index-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;defaults&quot;</span><span class="p">,</span>
  <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;index_patterns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
    <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;number_of_shards&quot;</span><span class="p">:</span> <span class="mi">3</span>
    <span class="p">},</span>
    <span class="s2">&quot;mappings&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;docs&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;_source&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;enabled&quot;</span><span class="p">:</span> <span class="n">false</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Types have been removed in Elasticsearch 7.0.0. If you want to benchmark Elasticsearch 7.0.0 or later you need to remove the mapping type above.</p>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="delete-composable-template">
<h4>delete-composable-template<a class="headerlink" href="#delete-composable-template" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-composable-template</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-delete-template.html">delete index template API</a>. It supports two modes: it deletes either all index templates that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section or it deletes one specific index template defined by this operation.</p>
<p>If you want it to delete all index templates that have been declared in the <code class="docutils literal notranslate"><span class="pre">composable-templates</span></code> section, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether an index template should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete index template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters.</p></li>
</ul>
<p>If you want it to delete one specific index template instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): The name of the composable template that should be deleted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether the index template should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete-matching-indices</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Whether to delete indices that match the index template’s index pattern.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index-pattern</span></code> (mandatory iff <code class="docutils literal notranslate"><span class="pre">delete-matching-indices</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>): Specifies the index pattern to delete.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete index template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters.</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>With the following snippet we will delete all index templates that are declared in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> section but only if they existed previously (implicit default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-all-index-templates&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-composable-template&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will delete the <cite>logs`</cite> index template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-logs-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-composable-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;logs&quot;</span><span class="p">,</span>
  <span class="s2">&quot;only-if-exists&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
  <span class="s2">&quot;delete-matching-indices&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;index-pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">delete-matching-indices</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, indices with the provided <code class="docutils literal notranslate"><span class="pre">index-pattern</span></code> are deleted regardless whether the index template has previously existed.</p>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="delete-component-template">
<h4>delete-component-template<a class="headerlink" href="#delete-component-template" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-component-template</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-delete-component-template.html">delete component template API</a>. It supports two modes: it deletes either all component templates that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section or it deletes one specific component template defined by this operation.</p>
<p>If you want it to delete all component templates that have been declared in the <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether a component template should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete component template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters.</p></li>
</ul>
<p>If you want it to delete one specific component template instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): The name of the component template that should be deleted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether the component template should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete component template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters.</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>With the following snippet we will delete all component templates that are declared in the <code class="docutils literal notranslate"><span class="pre">component-templates</span></code> section but only if they existed previously (implicit default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-all-component-templates&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-component-template&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will delete the <cite>component_template_with_2_shards`</cite> component template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-2-shards-component-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-component-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;component_template_with_2_shards&quot;</span><span class="p">,</span>
  <span class="s2">&quot;only-if-exists&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the component templates you are attempting to delete are referenced by composable templates, these must be deleted first using the <code class="docutils literal notranslate"><span class="pre">delete-composable-template</span></code> operation.</p>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="delete-index-template">
<h4>delete-index-template<a class="headerlink" href="#delete-index-template" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-index-template</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-delete-index.html">delete template API</a>. It supports two modes: it deletes either all index templates that are specified in the track’s <code class="docutils literal notranslate"><span class="pre">templates</span></code> section or it deletes one specific index template defined by this operation.</p>
<p>If you want it to delete all index templates that have been declared in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> section, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether an index template should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters.</p></li>
</ul>
<p>If you want it to delete one specific index template instead, you can specify the following properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">template</span></code> (mandatory): The name of the index that should be deleted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">only-if-exists</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">true</span></code>): Defines whether the index template should only be deleted if it exists.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delete-matching-indices</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Whether to delete indices that match the index template’s index pattern.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index-pattern</span></code> (mandatory iff <code class="docutils literal notranslate"><span class="pre">delete-matching-indices</span></code> is <code class="docutils literal notranslate"><span class="pre">true</span></code>): Specifies the index pattern to delete.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing any request parameters that are allowed by the delete template API. Rally will not attempt to serialize the parameters and pass them as is. Always use “true” / “false” strings for boolean parameters.</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>With the following snippet we will delete all index templates that are declared in the <code class="docutils literal notranslate"><span class="pre">templates</span></code> section but only if they existed previously (implicit default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-all-index-templates&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-index-template&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>With the following snippet we will delete the <cite>default`</cite> index template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-default-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-index-template&quot;</span><span class="p">,</span>
  <span class="s2">&quot;template&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
  <span class="s2">&quot;only-if-exists&quot;</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
  <span class="s2">&quot;delete-matching-indices&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;index-pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">delete-matching-indices</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, indices with the provided <code class="docutils literal notranslate"><span class="pre">index-pattern</span></code> are deleted regardless whether the index template has previously existed.</p>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="shrink-index">
<h4>shrink-index<a class="headerlink" href="#shrink-index" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">shrink-index</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-shrink-index.html">shrink index API</a>. Note that this does not correspond directly to the shrink index API call in Elasticsearch but it is a high-level operation that executes all the necessary low-level operations under the hood to shrink an index. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">source-index</span></code> (mandatory): The name of the index that should be shrinked. Multiple indices can be defined using the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/multi-index.html">Multi-target syntax</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-index</span></code> (mandatory): The name of the index that contains the shrinked shards. If multiple indices match <code class="docutils literal notranslate"><span class="pre">source-index</span></code>, one shrink operation will execute for every matching index. Each shrink operation will use a modified <code class="docutils literal notranslate"><span class="pre">target-index</span></code>: the unique suffix of the source index (derived by removing the common prefix of all matching source indices) will be appended to <code class="docutils literal notranslate"><span class="pre">target-index</span></code>. See also the example below.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target-body</span></code> (mandatory): The body containing settings and aliases for <code class="docutils literal notranslate"><span class="pre">target-index</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shrink-node</span></code> (optional, defaults to a random data node): As a first step, the source index needs to be fully relocated to a single node. Rally will automatically choose a random data node in the cluster but you can choose one explicitly if needed.</p></li>
</ul>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;shrink-index&quot;</span><span class="p">,</span>
  <span class="s2">&quot;shrink-node&quot;</span><span class="p">:</span> <span class="s2">&quot;rally-node-0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;source-index&quot;</span><span class="p">:</span> <span class="s2">&quot;src&quot;</span><span class="p">,</span>
  <span class="s2">&quot;target-index&quot;</span><span class="p">:</span> <span class="s2">&quot;target&quot;</span><span class="p">,</span>
  <span class="s2">&quot;target-body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;index.number_of_replicas&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;index.number_of_shards&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;index.codec&quot;</span><span class="p">:</span> <span class="s2">&quot;best_compression&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This will shrink the index <code class="docutils literal notranslate"><span class="pre">src</span></code> to <code class="docutils literal notranslate"><span class="pre">target</span></code>. The target index will consist of one shard and have one replica. With <code class="docutils literal notranslate"><span class="pre">shrink-node</span></code> we also explicitly specify the name of the node where we want the source index to be relocated to.</p>
<p>The following example <code class="docutils literal notranslate"><span class="pre">src*</span></code> matches a list of indices <code class="docutils literal notranslate"><span class="pre">src-a,src-b</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;shrink-index&quot;</span><span class="p">,</span>
  <span class="s2">&quot;shrink-node&quot;</span><span class="p">:</span> <span class="s2">&quot;rally-node-0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;source-index&quot;</span><span class="p">:</span> <span class="s2">&quot;src*&quot;</span><span class="p">,</span>
  <span class="s2">&quot;target-index&quot;</span><span class="p">:</span> <span class="s2">&quot;target&quot;</span><span class="p">,</span>
  <span class="s2">&quot;target-body&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;settings&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;index.number_of_replicas&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;index.number_of_shards&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
      <span class="s2">&quot;index.codec&quot;</span><span class="p">:</span> <span class="s2">&quot;best_compression&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>and will reindex <code class="docutils literal notranslate"><span class="pre">src-a</span></code> as <code class="docutils literal notranslate"><span class="pre">target-a</span></code> and <code class="docutils literal notranslate"><span class="pre">src-b</span></code> as <code class="docutils literal notranslate"><span class="pre">target-b</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="delete-ml-datafeed">
<h4>delete-ml-datafeed<a class="headerlink" href="#delete-ml-datafeed" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-ml-datafeed</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-delete-datafeed.html">delete datafeeds API</a>. The <code class="docutils literal notranslate"><span class="pre">delete-ml-datafeed</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datafeed-id</span></code> (mandatory): The name of the machine learning datafeed to delete.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Whether to force deletion of a datafeed that has already been started.</p></li>
</ul>
<p>This runner will intentionally ignore 404s from Elasticsearch so it is safe to execute this runner regardless whether a corresponding machine learning datafeed exists.</p>
<p>This operation works only if <a class="reference external" href="https://www.elastic.co/products/stack/machine-learning">machine-learning</a> is properly installed and enabled. This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</div>
<div class="section" id="create-ml-datafeed">
<h4>create-ml-datafeed<a class="headerlink" href="#create-ml-datafeed" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-ml-datafeed</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-put-datafeed.html">create datafeeds API</a>. The <code class="docutils literal notranslate"><span class="pre">create-ml-datafeed</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datafeed-id</span></code> (mandatory): The name of the machine learning datafeed to create.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): Request body containing the definition of the datafeed. Please see the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-put-datafeed.html">create datafeed API</a> documentation for more details.</p></li>
</ul>
<p>This operation works only if <a class="reference external" href="https://www.elastic.co/products/stack/machine-learning">machine-learning</a> is properly installed and enabled. This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="start-ml-datafeed">
<h4>start-ml-datafeed<a class="headerlink" href="#start-ml-datafeed" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">start-ml-datafeed</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-start-datafeed.html">start datafeeds API</a>. The <code class="docutils literal notranslate"><span class="pre">start-ml-datafeed</span></code> operation supports the following parameters which are documented in the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-start-datafeed.html">start datafeed API</a> documentation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datafeed-id</span></code> (mandatory): The name of the machine learning datafeed to start.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (optional, defaults to empty): Request body with start parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> (optional, defaults to empty): Start timestamp of the datafeed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code> (optional, defaults to empty): End timestamp of the datafeed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> (optional, defaults to empty): Amount of time to wait until a datafeed starts.</p></li>
</ul>
<p>This operation works only if <a class="reference external" href="https://www.elastic.co/products/stack/machine-learning">machine-learning</a> is properly installed and enabled. This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="stop-ml-datafeed">
<h4>stop-ml-datafeed<a class="headerlink" href="#stop-ml-datafeed" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">stop-ml-datafeed</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-stop-datafeed.html">stop datafeed API</a>. The <code class="docutils literal notranslate"><span class="pre">stop-ml-datafeed</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datafeed-id</span></code> (mandatory): The name of the machine learning datafeed to start.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Whether to forcefully stop an already started datafeed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> (optional, defaults to empty): Amount of time to wait until a datafeed stops.</p></li>
</ul>
<p>This operation works only if <a class="reference external" href="https://www.elastic.co/products/stack/machine-learning">machine-learning</a> is properly installed and enabled. This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="delete-ml-job">
<h4>delete-ml-job<a class="headerlink" href="#delete-ml-job" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-ml-job</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-delete-job.html">delete jobs API</a>. The <code class="docutils literal notranslate"><span class="pre">delete-ml-job</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">job-id</span></code> (mandatory): The name of the machine learning job to delete.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Whether to force deletion of a job that has already been opened.</p></li>
</ul>
<p>This runner will intentionally ignore 404s from Elasticsearch so it is safe to execute this runner regardless whether a corresponding machine learning job exists.</p>
<p>This operation works only if <a class="reference external" href="https://www.elastic.co/products/stack/machine-learning">machine-learning</a> is properly installed and enabled. This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-ml-job">
<h4>create-ml-job<a class="headerlink" href="#create-ml-job" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-ml-job</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-put-job.html">create jobs API</a>. The <code class="docutils literal notranslate"><span class="pre">create-ml-job</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">job-id</span></code> (mandatory): The name of the machine learning job to create.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): Request body containing the definition of the job. Please see the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-put-job.html">create job API</a> documentation for more details.</p></li>
</ul>
<p>This operation works only if <a class="reference external" href="https://www.elastic.co/products/stack/machine-learning">machine-learning</a> is properly installed and enabled. This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="open-ml-job">
<h4>open-ml-job<a class="headerlink" href="#open-ml-job" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">open-ml-job</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-open-job.html">open jobs API</a>. The <code class="docutils literal notranslate"><span class="pre">open-ml-job</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">job-id</span></code> (mandatory): The name of the machine learning job to open.</p></li>
</ul>
<p>This operation works only if <a class="reference external" href="https://www.elastic.co/products/stack/machine-learning">machine-learning</a> is properly installed and enabled. This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="close-ml-job">
<h4>close-ml-job<a class="headerlink" href="#close-ml-job" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">close-ml-job</span></code> you can execute the <cite>close jobs API. The ``close-ml-job`</cite> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">job-id</span></code> (mandatory): The name of the machine learning job to start.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>): Whether to forcefully stop an already opened job.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> (optional, defaults to empty): Amount of time to wait until a job stops.</p></li>
</ul>
<p>This operation works only if <a class="reference external" href="https://www.elastic.co/products/stack/machine-learning">machine-learning</a> is properly installed and enabled. This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="raw-request">
<h4>raw-request<a class="headerlink" href="#raw-request" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">raw-request</span></code> you can execute arbitrary HTTP requests against Elasticsearch. This is a low-level operation that should only be used if no high-level operation is available. Note that it is always possible to write a <a class="reference internal" href="adding_tracks.html#adding-tracks-custom-runners"><span class="std std-ref">custom runner</span></a>. The <code class="docutils literal notranslate"><span class="pre">raw-request</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">GET</span></code>): The HTTP request method to use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code> (mandatory): Path for the API call (excluding host and port). The path must begin with a <code class="docutils literal notranslate"><span class="pre">/</span></code>. Example: <code class="docutils literal notranslate"><span class="pre">/myindex/_flush</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">header</span></code> (optional): A structure containing any request headers as key-value pairs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (optional): The document body.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing HTTP request parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore</span></code> (optional): An array of HTTP response status codes to ignore (i.e. consider as successful).</p></li>
</ul>
</div>
<div class="section" id="sleep">
<h4>sleep<a class="headerlink" href="#sleep" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">sleep</span></code> you can sleep for a certain duration to ensure no requests are executed by the corresponding clients. The <code class="docutils literal notranslate"><span class="pre">sleep</span></code> operation supports the following parameter:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">duration</span></code> (mandatory): A non-negative number that defines the sleep duration in seconds.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sleep</span></code> operation is only useful in very limited circumstances. To throttle throughput, specify a <code class="docutils literal notranslate"><span class="pre">target-throughput</span></code> on the corresponding task instead.</p>
</div>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</div>
<div class="section" id="delete-snapshot-repository">
<h4>delete-snapshot-repository<a class="headerlink" href="#delete-snapshot-repository" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-snapshot-repository</span></code> you can delete an existing snapshot repository. The <code class="docutils literal notranslate"><span class="pre">delete-snapshot-repository</span></code> operation supports the following parameter:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">repository</span></code> (mandatory): The name of the snapshot repository to delete.</p></li>
</ul>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-snapshot-repository">
<h4>create-snapshot-repository<a class="headerlink" href="#create-snapshot-repository" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-snapshot-repository</span></code> you can create a new snapshot repository. The <code class="docutils literal notranslate"><span class="pre">create-snapshot-repository</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">repository</span></code> (mandatory): The name of the snapshot repository to create.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): The body of the create snapshot repository request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing HTTP request parameters.</p></li>
</ul>
<p>This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-snapshot">
<h4>create-snapshot<a class="headerlink" href="#create-snapshot" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-snapshot</span></code> you can <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/snapshots-take-snapshot.html">create a snapshot</a>. The <code class="docutils literal notranslate"><span class="pre">create-snapshot</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">repository</span></code> (mandatory): The name of the snapshot repository to use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshot</span></code> (mandatory): The name of the snapshot to create.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): The body of the create snapshot request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wait-for-completion</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>): Whether this call should return immediately or block until the snapshot is created.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing HTTP request parameters.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It’s not recommended to rely on <code class="docutils literal notranslate"><span class="pre">wait-for-completion=true</span></code>. Instead you should keep the default value (<code class="docutils literal notranslate"><span class="pre">False</span></code>) and use an additional <code class="docutils literal notranslate"><span class="pre">wait-for-snapshot-create</span></code> operation in the next step.
This is mandatory on <a class="reference external" href="https://www.elastic.co/cloud">Elastic Cloud</a> or environments where Elasticsearch is connected via intermediate network components, such as proxies, that may terminate the blocking connection after a timeout.</p>
</div>
</div>
<div class="section" id="wait-for-snapshot-create">
<h4>wait-for-snapshot-create<a class="headerlink" href="#wait-for-snapshot-create" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">wait-for-snapshot-create</span></code> you can wait until a <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/get-snapshot-status-api.html">snapshot has finished successfully</a>.
Typically you’ll use this operation directly after a <code class="docutils literal notranslate"><span class="pre">create-snapshot</span></code> operation.</p>
<p>It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">repository</span></code> (mandatory): The name of the snapshot repository to use.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshot</span></code> (mandatory): The name of the snapshot that this operation will wait until it succeeds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">completion-recheck-wait-period</span></code> (optional, defaults to 1 second): Time in seconds to wait in between consecutive attempts.</p></li>
</ul>
<p>Rally will report the achieved throughput in byte/s.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="restore-snapshot">
<h4>restore-snapshot<a class="headerlink" href="#restore-snapshot" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">restore-snapshot</span></code> you can restore a snapshot from an already created snapshot repository. The <code class="docutils literal notranslate"><span class="pre">restore-snapshot</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">repository</span></code> (mandatory): The name of the snapshot repository to use. This snapshot repository must exist prior to calling <code class="docutils literal notranslate"><span class="pre">restore-snapshot</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshot</span></code> (mandatory): The name of the snapshot to restore.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (optional): The body of the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-snapshots.html#restore-snapshot">snapshot restore request</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wait-for-completion</span></code> (optional, defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>): Whether this call should return immediately or block until the snapshot is restored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing HTTP request parameters.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to ensure that the track execution only continues after a snapshot has been restored, set <code class="docutils literal notranslate"><span class="pre">wait-for-completion</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code> <strong>and</strong> increase the request timeout. In the example below we set it to 7200 seconds (or 2 hours):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;request_timeout&quot;</span><span class="p">:</span> <span class="mi">7200</span>
<span class="p">}</span>
</pre></div>
</div>
<p>However, this might not work if a proxy is in between the client and Elasticsearch and the proxy has a shorter request timeout configured than the client. In this case, keep the default value for <code class="docutils literal notranslate"><span class="pre">wait-for-completion</span></code> and instead add a <code class="docutils literal notranslate"><span class="pre">wait-for-recovery</span></code> runner in the next step.</p>
</div>
</div>
<div class="section" id="wait-for-recovery">
<h4>wait-for-recovery<a class="headerlink" href="#wait-for-recovery" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">wait-for-recovery</span></code> you can wait until an ongoing shard recovery finishes. The <code class="docutils literal notranslate"><span class="pre">wait-for-recovery</span></code> operation supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> (mandatory): The name of the index or an index pattern which is being recovered.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">completion-recheck-wait-period</span></code> (optional, defaults to 1 seconds): Time in seconds to wait in between consecutive attempts.</p></li>
</ul>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="create-transform">
<h4>create-transform<a class="headerlink" href="#create-transform" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">create-transform</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/put-transform.html">create transform API</a>. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transform-id</span></code> (mandatory): The id of the transform to create.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): Request body containing the configuration of the transform. Please see the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/put-transform.html">create transform API</a> documentation for more details.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">defer-validation</span></code> (optional, defaults to false): When true, deferrable validations are not run. This behavior may be desired if the source index does not exist until after the transform is created.</p></li>
</ul>
<p>This operation requires at least Elasticsearch 7.5.0 (non-OSS). This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="start-transform">
<h4>start-transform<a class="headerlink" href="#start-transform" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">start-transform</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/start-transform.html">start transform API</a>. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transform-id</span></code> (mandatory): The id of the transform to start.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> (optional, defaults to empty): Amount of time to wait until a transform starts.</p></li>
</ul>
<p>This operation requires at least Elasticsearch 7.5.0 (non-OSS). This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="wait-for-transform">
<h4>wait-for-transform<a class="headerlink" href="#wait-for-transform" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">wait-for-transform</span></code> you can stop a transform after a certain amount of work is done. Use this operation for measuring performance. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transform-id</span></code> (mandatory): The id of the transform to stop.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force</span></code> (optional, defaults to false): Whether to forcefully stop the transform.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">timeout</span></code> (optional, defaults to empty): Amount of time to wait until a transform stops.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wait-for-completion</span></code> (optional, defaults to true) If set to true, causes the API to block until the indexer state completely stops.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wait-for-checkpoint</span></code> (optional, defaults to true) If set to true, the transform will not completely stop until the current checkpoint is completed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transform-timeout</span></code> (optional, defaults to <cite>3600</cite> (<cite>1h</cite>)) Overall runtime timeout of the batch transform in seconds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">poll-interval</span></code> (optional, defaults to <cite>0.5</cite>) How often transform stats are polled, used to set progress and check the state. You should not set this too low, because polling can skew the result.</p></li>
</ul>
<p>This operation requires at least Elasticsearch 7.5.0 (non-OSS). This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="delete-transform">
<h4>delete-transform<a class="headerlink" href="#delete-transform" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">delete-transform</span></code> you can execute the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/delete-transform.html">delete transform API</a>. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transform-id</span></code> (mandatory): The id of the transform to delete.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force</span></code> (optional, defaults to false): Whether to delete the transform regardless of its current state.</p></li>
</ul>
<p>This operation requires at least Elasticsearch 7.5.0 (non-OSS). This is an administrative operation. Metrics are not reported by default. Reporting can be forced by setting <code class="docutils literal notranslate"><span class="pre">include-in-reporting</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>.</p>
</div>
<div class="section" id="composite">
<h4>composite<a class="headerlink" href="#composite" title="Permalink to this headline">¶</a></h4>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">composite</span></code> you can specify complex operations consisting of multiple requests to Elasticsearch. This can be used to simulate more complex application behavior, like populating a search page with custom filters. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">requests</span></code> (mandatory): A list that specifies the request streams to execute. Each stream consists of operations of either type <code class="docutils literal notranslate"><span class="pre">raw-request</span></code> to send requests to Elasticsearch or <code class="docutils literal notranslate"><span class="pre">sleep</span></code> to simulate client processing time. Streams execute concurrently, operations within a stream sequentially. It is possible to nest streams. See below for specific examples.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max-connections</span></code> (optional: defaults to unbounded): The maximum number of concurrent connections per client executing this composite operation. By default, the operation itself does not restrict the number of connections but is bound to Rally’s network connection limit. Therefore raise the number of available network connections appropriately (see <a class="reference internal" href="command_line_reference.html#clr-client-options"><span class="std std-ref">command line reference</span></a>).</p></li>
</ul>
<p><strong>Examples</strong></p>
<p>Here we execute two requests concurrently in two streams. The <code class="docutils literal notranslate"><span class="pre">composite</span></code> operation will return when both concurrent requests have finished:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;load-posts-search-page&quot;</span><span class="p">,</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;composite&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requests&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;raw-request&quot;</span><span class="p">,</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/posts/_search&quot;</span><span class="p">,</span>
                <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;bool&quot;</span><span class="p">:</span> <span class="p">{</span>
                      <span class="s2">&quot;must&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;query_string&quot;</span><span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="s2">&quot;Java Performance&quot;</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">}</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;raw-request&quot;</span><span class="p">,</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/users/_search&quot;</span><span class="p">,</span>
                <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;term&quot;</span><span class="p">:</span> <span class="p">{</span>
                      <span class="s2">&quot;user.id&quot;</span><span class="p">:</span> <span class="s2">&quot;876591234&quot;</span>
                    <span class="p">}</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If multiple requests should be executed in sequence, put them in one stream. In the following example we issue two requests sequentially with a 500ms think time in between:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;load-search-page-and-user&quot;</span><span class="p">,</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;composite&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requests&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;raw-request&quot;</span><span class="p">,</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/posts/_search&quot;</span><span class="p">,</span>
                <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;bool&quot;</span> <span class="p">:</span> <span class="p">{</span>
                      <span class="s2">&quot;must&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;query_string&quot;</span> <span class="p">:</span> <span class="p">{</span>
                          <span class="s2">&quot;query&quot;</span> <span class="p">:</span> <span class="s2">&quot;Java Performance&quot;</span>
                        <span class="p">}</span>
                      <span class="p">}</span>
                    <span class="p">}</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="p">{</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;sleep&quot;</span><span class="p">,</span>
                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mf">0.5</span>
              <span class="p">},</span>
              <span class="p">{</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;raw-request&quot;</span><span class="p">,</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/users/_search&quot;</span><span class="p">,</span>
                <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;term&quot;</span><span class="p">:</span> <span class="p">{</span>
                      <span class="s2">&quot;user.id&quot;</span><span class="p">:</span> <span class="s2">&quot;876591234&quot;</span>
                    <span class="p">}</span>
                  <span class="p">}</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To keep the following example brief, only the <code class="docutils literal notranslate"><span class="pre">operation-type</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code> properties are shown.</p>
</div>
<p>We can also nest streams:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;load-posts-search-page&quot;</span><span class="p">,</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;composite&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requests&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;find-matching-posts&quot;</span><span class="p">,</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;raw-request&quot;</span>
              <span class="p">},</span>
              <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;client-processing&quot;</span><span class="p">,</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;sleep&quot;</span><span class="p">,</span>
                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mf">0.04</span>
              <span class="p">},</span>
              <span class="p">{</span>
                <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;find-related-posts&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;raw-request&quot;</span>
                  <span class="p">}</span>
                <span class="p">]</span>
              <span class="p">},</span>
              <span class="p">{</span>
                <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
                  <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;find-top-posts&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;raw-request&quot;</span>
                  <span class="p">}</span>
                <span class="p">]</span>
              <span class="p">}</span>

            <span class="p">]</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;load-user&quot;</span><span class="p">,</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;raw-request&quot;</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following diagram depicts in which order requests are executed; the specific timings just serve as an illustration.</p>
<img alt="Timing view of nested streams" src="_images/nested-streams.png" />
</div>
<div class="section" id="submit-async-search">
<h4>submit-async-search<a class="headerlink" href="#submit-async-search" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation can only be used inside a <code class="docutils literal notranslate"><span class="pre">composite</span></code> operation because it needs to pass the async search id to following API calls.</p>
</div>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">submit-async-search</span></code> you can <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/async-search.html#submit-async-search">submit an async search</a>. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> (mandatory): The unique name of this operation. Use this name in <code class="docutils literal notranslate"><span class="pre">get-async-search</span></code> and <code class="docutils literal notranslate"><span class="pre">delete-async-search</span></code> calls later on to wait for search results and delete them in Elasticsearch.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">body</span></code> (mandatory): The query body.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing arbitrary request parameters. The supported parameters names are documented in the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/async-search.html#submit-async-search">submit async search docs</a>.</p></li>
</ul>
</div>
<div class="section" id="get-async-search">
<h4>get-async-search<a class="headerlink" href="#get-async-search" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation can only be used inside a <code class="docutils literal notranslate"><span class="pre">composite</span></code> operation because it needs to read the async search id from earlier API calls.</p>
</div>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">get-async-search</span></code> you can <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/async-search.html#get-async-search">get the results of an async search</a>. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">retrieve-results-for</span></code> (mandatory): A list of names of <code class="docutils literal notranslate"><span class="pre">submit-async-search</span></code> requests to wait for. Async searches that have already completed within <code class="docutils literal notranslate"><span class="pre">wait_for_completion_timeout</span></code> are skipped automatically.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request-params</span></code> (optional): A structure containing arbitrary request parameters. The supported parameters names are documented in the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/async-search.html#get-async-search">get async search docs</a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation is <a class="reference internal" href="#track-operations"><span class="std std-ref">retryable</span></a>. It will wait by default until all async searches specified by <code class="docutils literal notranslate"><span class="pre">retrieve-results-for</span></code> have finished. To disable this behavior, specify set <code class="docutils literal notranslate"><span class="pre">retry-until-success</span></code> to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</div>
</div>
<div class="section" id="delete-async-search">
<h4>delete-async-search<a class="headerlink" href="#delete-async-search" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This operation can only be used inside a <code class="docutils literal notranslate"><span class="pre">composite</span></code> operation because it needs to read the async search id from earlier API calls.</p>
</div>
<p>With the operation <code class="docutils literal notranslate"><span class="pre">get-async-search</span></code> you can <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/async-search.html#delete-async-search">delete an async search</a>. It supports the following parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">delete-results-for</span></code> (mandatory): A list of names of <code class="docutils literal notranslate"><span class="pre">submit-async-search</span></code> requests for which results should be deleted. Async searches that have already completed within <code class="docutils literal notranslate"><span class="pre">wait_for_completion_timeout</span></code> are skipped automatically.</p></li>
</ul>
<p><strong>Example</strong></p>
<p>In the example below we issue two async searches, named <code class="docutils literal notranslate"><span class="pre">search-1</span></code> and <code class="docutils literal notranslate"><span class="pre">search-2</span></code> concurrently, wait for the results, simulate processing them with a <code class="docutils literal notranslate"><span class="pre">sleep</span></code> operation and finally delete the async search results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;composite&quot;</span><span class="p">,</span>
        <span class="s2">&quot;requests&quot;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span>
            <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;submit-async-search&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;search-1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;match_all&quot;</span><span class="p">:</span> <span class="p">{}</span>
                  <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;wait_for_completion_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;100ms&quot;</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span>
                <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;submit-async-search&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;search-2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;match_all&quot;</span><span class="p">:</span> <span class="p">{}</span>
                  <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;request-params&quot;</span><span class="p">:</span> <span class="p">{</span>
                  <span class="s2">&quot;wait_for_completion_timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;200ms&quot;</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;get-async-search&quot;</span><span class="p">,</span>
            <span class="s2">&quot;retrieve-results-for&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;search-1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;search-2&quot;</span>
            <span class="p">]</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;simulate-client-side-result-processing&quot;</span><span class="p">,</span>
            <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;sleep&quot;</span><span class="p">,</span>
            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="mf">0.2</span>
          <span class="p">},</span>
          <span class="p">{</span>
            <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;delete-async-search&quot;</span><span class="p">,</span>
            <span class="s2">&quot;delete-results-for&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="s2">&quot;search-1&quot;</span><span class="p">,</span>
              <span class="s2">&quot;search-2&quot;</span>
            <span class="p">]</span>
          <span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-track-with-a-single-task">
<span id="track-single-task"></span><h3>A track with a single task<a class="headerlink" href="#a-track-with-a-single-task" title="Permalink to this headline">¶</a></h3>
<p>To get started with custom tracks, you can benchmark a single task, e.g. a match_all query:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;operation-type&quot;</span><span class="p">:</span> <span class="s2">&quot;search&quot;</span><span class="p">,</span>
        <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;_all&quot;</span><span class="p">,</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;query&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;match_all&quot;</span><span class="p">:</span> <span class="p">{}</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">10</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This track assumes that you have an existing cluster with pre-populated data. It will run the provided <code class="docutils literal notranslate"><span class="pre">match_all</span></code> query at 10 operations per second with one client and use 100 iterations as warmup and the next 100 iterations to measure.</p>
<p>For the examples below, note that we do not show the operation definition but you should be able to infer from the operation name what it is doing.</p>
</div>
<div class="section" id="running-unthrottled">
<h3>Running unthrottled<a class="headerlink" href="#running-unthrottled" title="Permalink to this headline">¶</a></h3>
<p>In this example Rally will run a bulk index operation unthrottled for one hour:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;bulk&quot;</span><span class="p">,</span>
    <span class="s2">&quot;warmup-time-period&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
    <span class="s2">&quot;time-period&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">8</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="running-tasks-in-parallel">
<h3>Running tasks in parallel<a class="headerlink" href="#running-tasks-in-parallel" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You cannot nest parallel tasks.</p>
</div>
<p>If we want to run tasks in parallel, we can use the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element. In the simplest case, you let Rally decide the number of clients needed to run the parallel tasks (note how we can define default values on the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;term&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Rally will determine that three clients are needed to run each task in a dedicated client. You can also see that each task can have different settings.</p>
<p>However, you can also explicitly define the number of clients:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;match-all&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;term&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This schedule will run a match all query, a term query and a phrase query concurrently. It will run with eight clients in total (four for the match all query and two each for the term and phrase query).</p>
<p>In this scenario, we run indexing and a few queries in parallel with a total of 14 clients:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;bulk&quot;</span><span class="p">,</span>
          <span class="s2">&quot;warmup-time-period&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
          <span class="s2">&quot;time-period&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
          <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;term&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
          <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
          <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">completed-by</span></code> to stop querying as soon as bulk-indexing has completed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;completed-by&quot;</span><span class="p">:</span> <span class="s2">&quot;bulk&quot;</span><span class="p">,</span>
      <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;bulk&quot;</span><span class="p">,</span>
          <span class="s2">&quot;warmup-time-period&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
          <span class="s2">&quot;time-period&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;warmup-time-period&quot;</span><span class="p">:</span> <span class="mi">480</span><span class="p">,</span>
          <span class="s2">&quot;time-period&quot;</span><span class="p">:</span> <span class="mi">7200</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>We can also mix sequential tasks with the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> element. In this scenario we are indexing with 8 clients and continue querying with 6 clients after indexing has finished:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;bulk&quot;</span><span class="p">,</span>
    <span class="s2">&quot;warmup-time-period&quot;</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
    <span class="s2">&quot;time-period&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;term&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span>
          <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Be aware of the following case where we explicitly define that we want to run only with two clients <em>in total</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
      <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
      <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
      <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;match-all&quot;</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;term&quot;</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span>
          <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Rally will <em>not</em> run all three tasks in parallel because you specified that you want only two clients in total. Hence, Rally will first run “match-all” and “term” concurrently (with one client each). After they have finished, Rally will run “phrase” with one client. You could also specify more clients than there are tasks but these will then just idle.</p>
<p>You can also specify a number of clients on sub tasks explicitly (by default, one client is assumed per subtask). This allows to define a weight for each client operation. Note that you need to define the number of clients also on the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> parent element, otherwise Rally would determine the number of total needed clients again on its own:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;parallel&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;warmup-iterations&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="s2">&quot;iterations&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">50</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;term&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;target-throughput&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;clients&quot;</span><span class="p">:</span> <span class="mi">2</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This will ensure that the phrase query will be executed by two clients. All other ones are executed by one client.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="car.html" class="btn btn-neutral float-right" title="Configure Elasticsearch: Cars" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="offline.html" class="btn btn-neutral float-left" title="Offline Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Elasticsearch B.V.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>